{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "title": "",
        "description": "",
        "prerequisites": "",
    "postDeployment": [],
    "prerequisitesDeployTemplateFile": "",
    "lastUpdateTime": "",
"entities": [],
"tags": [],
"support": {
"tier": "community",
"armtemplate": "Generated"
},
"author": {
"name": ""
}
},
"parameters": {
"PlaybookName": {
"defaultValue": "Module-GetManager",
"type": "string"
}
},
"variables": {},
"resources": [
{
"properties": {
"provisioningState": "Succeeded",
"state": "Enabled",
"definition": {
    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "$connections": {
        "defaultValue": {},
        "type": "Object"
    }
},
"triggers": {
    "When_a_HTTP_request_is_received": {
        "type": "Request",
        "kind": "Http",
        "inputs": {
            "schema": {
                "properties": {
                    "userPrincipalName": {
                        "type": "string"
                    }
                },
                "type": "object"
            }
        }
    }
},
"actions": {
    "Get_manager_(V2)": {
    "runAfter": {},
    "type": "ApiConnection",
    "inputs": {
        "host": {
            "connection": {
                "name": "@parameters('$connections')['office365users']['connectionId']"
            }
        },
        "method": "get",
        "path": "/codeless/v1.0/users/@{encodeURIComponent(triggerBody()?['userPrincipalName'])}/manager"
    }
},
"Response": {
    "runAfter": {
        "Get_manager_(V2)": [
            "Succeeded"
        ]
    },
    "type": "Response",
    "kind": "Http",
    "inputs": {
        "statusCode": 200,
        "body": {
            "manager": "@{body('Get_manager_(V2)')?['userPrincipalName']}",
            "jobTitle": "@{body('Get_manager_(V2)')?['jobTitle']}",
            "department": "@{body('Get_manager_(V2)')?['responsibilities']}",
            "location": "@{body('Get_manager_(V2)')?['officeLocation']}"
        }
    }
}
},
"outputs": {}
},
"parameters": {
"$connections": {
"value": {
"office365users": {
    "connectionId": "/subscriptions/5305ccd2-977a-4630-843b-bad582e756a3/resourceGroups/STL-SEC-AUTOMATION-RG/providers/Microsoft.Web/connections/Office365users-Module-GetManager",
    "connectionName": "Office365users-Module-GetManager",
    "id": "/subscriptions/5305ccd2-977a-4630-843b-bad582e756a3/providers/Microsoft.Web/locations/uksouth/managedApis/Office365users"
}
}
}
}
},
"name": "[parameters('PlaybookName')]",
"type": "Microsoft.Logic/workflows",
"location": "[resourceGroup().location]",
"tags": {
"Environment": "Azure",
"Application": "Microsoft Sentinel",
"Purpose": "Microsoft Office 365",
"hidden-SentinelTemplateName": "Module-GetManager",
"hidden-SentinelTemplateVersion": "1.0"
},
"identity": {
"type": "SystemAssigned"
},
"apiVersion": "2017-07-01",
"dependsOn": []
}
]
}
